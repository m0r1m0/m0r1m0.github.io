{"pageProps":{"date":"2022年03月27日","title":"TypeScript で Google Cloud Functions の関数を書く","content":"<p><a href=\"https://github.com/GoogleCloudPlatform/functions-framework-nodejs\">functions-framework-nodejs</a> を使う。</p>\n<h2>開発環境を準備する</h2>\n<p><a href=\"https://github.com/GoogleCloudPlatform/functions-framework-nodejs/blob/master/docs/typescript.md\">ドキュメント</a>に従い、セットアップする。</p>\n<h2>書く</h2>\n<pre><code class=\"hljs language-ts\"><span class=\"hljs-keyword\">import</span> {HttpFunction} <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'@google-cloud/functions-framework'</span>;\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">const</span> helloWorld: HttpFunction = <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =></span> {\n  res.send(<span class=\"hljs-string\">'Hello, World'</span>);\n};</code></pre>\n<h2>ローカルで実行する</h2>\n<pre><code class=\"hljs language-bash\">npm run watch</code></pre>\n<h2>デプロイ</h2>\n<p>セットアップで gts init したときに、npm scripts に <code>prepare</code> が追加されている。compile済みのものをデプロイする&#x26;typescriptはdevDependenciesなので、不要。削除する。</p>\n<pre><code class=\"hljs language-diff\"><span class=\"hljs-deletion\">- \"prepare\": \"npm run compile\",</span></code></pre>\n<p>デプロイ</p>\n<pre><code class=\"hljs language-bash\">gcloud <span class=\"hljs-built_in\">functions</span> deploy helloWorld \\\n--runtime nodejs16 \\\n--trigger-http \\\n--allow-unauthenticated</code></pre>\n","ogp":{"title":"TypeScript で Google Cloud Functions の関数を書く","description":"[functions-framework-nodejs](https://github.com/GoogleCloudPlatform/functions-framework-nodejs) を使う。"}},"__N_SSG":true}