<!DOCTYPE html><html><head><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-N6MC6SMGJM"></script><script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-N6MC6SMGJM', {
              page_path: window.location.pathname,
            });
          </script><link rel="alternate" type="application/rss+xml" title="RSS feed" href="/rss.xml"/><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>TypeScript で Google Cloud Functions の関数を書く</title><meta property="og:title" content="TypeScript で Google Cloud Functions の関数を書く"/><meta property="og:description" content="[functions-framework-nodejs](https://github.com/GoogleCloudPlatform/functions-framework-nodejs) を使う。"/><meta name="twitter:card" content="summary"/><meta name="next-head-count" content="6"/><link rel="preload" href="/_next/static/css/1e8ccdab538ecc583dd2.css" as="style"/><link rel="stylesheet" href="/_next/static/css/1e8ccdab538ecc583dd2.css" data-n-g=""/><link rel="preload" href="/_next/static/css/8c35c68098dd8759f6c1.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8c35c68098dd8759f6c1.css" data-n-p=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-1aebe1c5ebad78b6eefd.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.2113c6061a2f456066a1.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.040a3874e38b7cc6b430.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-5874fa266a7d44909009.js" as="script"/><link rel="preload" href="/_next/static/chunks/c5b568cee8545d966ddc8d89f9063461e084494a.bb32f9c4396722e794d4.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/articles/%5Bid%5D-16081245fdd7df34b03c.js" as="script"/></head><body><div id="__next"><div class="layout_container__2t4v2"><header class="layout_header__2rhWq"><h1 class="layout_title__24-9Z"><a href="/">🌳MORIMO🌳</a></h1></header><main><article class="detail_article__3SXso"><div><span>2022年03月27日</span><h1>TypeScript で Google Cloud Functions の関数を書く</h1></div><div><p><a href="https://github.com/GoogleCloudPlatform/functions-framework-nodejs">functions-framework-nodejs</a> を使う。</p>
<h2>開発環境を準備する</h2>
<p><a href="https://github.com/GoogleCloudPlatform/functions-framework-nodejs/blob/master/docs/typescript.md">ドキュメント</a>に従い、セットアップする。</p>
<h2>書く</h2>
<pre><code class="hljs language-ts"><span class="hljs-keyword">import</span> {HttpFunction} <span class="hljs-keyword">from</span> <span class="hljs-string">'@google-cloud/functions-framework'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> helloWorld: HttpFunction = <span class="hljs-function">(<span class="hljs-params">req, res</span>) =></span> {
  res.send(<span class="hljs-string">'Hello, World'</span>);
};</code></pre>
<h2>ローカルで実行する</h2>
<pre><code class="hljs language-bash">npm run watch</code></pre>
<h2>デプロイ</h2>
<p>セットアップで gts init したときに、npm scripts に <code>prepare</code> が追加されている。compile済みのものをデプロイする&#x26;typescriptはdevDependenciesなので、不要。削除する。</p>
<pre><code class="hljs language-diff"><span class="hljs-deletion">- "prepare": "npm run compile",</span></code></pre>
<p>デプロイ</p>
<pre><code class="hljs language-bash">gcloud <span class="hljs-built_in">functions</span> deploy helloWorld \
--runtime nodejs16 \
--trigger-http \
--allow-unauthenticated</code></pre>
</div></article></main></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"date":"2022年03月27日","title":"TypeScript で Google Cloud Functions の関数を書く","content":"\u003cp\u003e\u003ca href=\"https://github.com/GoogleCloudPlatform/functions-framework-nodejs\"\u003efunctions-framework-nodejs\u003c/a\u003e を使う。\u003c/p\u003e\n\u003ch2\u003e開発環境を準備する\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/GoogleCloudPlatform/functions-framework-nodejs/blob/master/docs/typescript.md\"\u003eドキュメント\u003c/a\u003eに従い、セットアップする。\u003c/p\u003e\n\u003ch2\u003e書く\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e {HttpFunction} \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'@google-cloud/functions-framework'\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e helloWorld: HttpFunction = \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003ereq, res\u003c/span\u003e) =\u003e\u003c/span\u003e {\n  res.send(\u003cspan class=\"hljs-string\"\u003e'Hello, World'\u003c/span\u003e);\n};\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eローカルで実行する\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003enpm run watch\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eデプロイ\u003c/h2\u003e\n\u003cp\u003eセットアップで gts init したときに、npm scripts に \u003ccode\u003eprepare\u003c/code\u003e が追加されている。compile済みのものをデプロイする\u0026#x26;typescriptはdevDependenciesなので、不要。削除する。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-diff\"\u003e\u003cspan class=\"hljs-deletion\"\u003e- \"prepare\": \"npm run compile\",\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eデプロイ\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003egcloud \u003cspan class=\"hljs-built_in\"\u003efunctions\u003c/span\u003e deploy helloWorld \\\n--runtime nodejs16 \\\n--trigger-http \\\n--allow-unauthenticated\u003c/code\u003e\u003c/pre\u003e\n","ogp":{"title":"TypeScript で Google Cloud Functions の関数を書く","description":"[functions-framework-nodejs](https://github.com/GoogleCloudPlatform/functions-framework-nodejs) を使う。"}},"__N_SSG":true},"page":"/articles/[id]","query":{"id":"2022-03-27-cloud-functions-typescript"},"buildId":"0x4ysPDBqiIcgC0fc0HvO","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-11c8eba6a84e3fddec04.js"></script><script src="/_next/static/chunks/main-1aebe1c5ebad78b6eefd.js" async=""></script><script src="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" async=""></script><script src="/_next/static/chunks/framework.2113c6061a2f456066a1.js" async=""></script><script src="/_next/static/chunks/commons.040a3874e38b7cc6b430.js" async=""></script><script src="/_next/static/chunks/pages/_app-5874fa266a7d44909009.js" async=""></script><script src="/_next/static/chunks/c5b568cee8545d966ddc8d89f9063461e084494a.bb32f9c4396722e794d4.js" async=""></script><script src="/_next/static/chunks/pages/articles/%5Bid%5D-16081245fdd7df34b03c.js" async=""></script><script src="/_next/static/0x4ysPDBqiIcgC0fc0HvO/_buildManifest.js" async=""></script><script src="/_next/static/0x4ysPDBqiIcgC0fc0HvO/_ssgManifest.js" async=""></script></body></html>